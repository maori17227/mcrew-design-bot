# Финальные обновления Mini App

## Что сделано:

### ✅ 1. Автоматическая проверка USDT транзакций
- **Проверка каждые 30 секунд** через TronScan API
- **Автоматическое зачисление** на баланс при получении USDT
- **Уведомления** о зачислении средств
- **Сохранение транзакций** в localStorage и API
- **Формула**: 1 USDT = 1 ɱ (100 mini)

#### Как работает:
1. Пользователь отправляет USDT на адрес `TJDENsfBJs4RFETt1X1W8wMDc8M5XnJhCe`
2. Каждые 30 секунд система проверяет новые транзакции
3. При обнаружении новой транзакции:
   - Конвертирует USDT в MTV (1:1)
   - Добавляет на баланс пользователя
   - Показывает уведомление
   - Сохраняет транзакцию

### ✅ 2. Исправлен TON Connect
- **Проблема**: Модальное окно TON Connect появлялось за другими элементами
- **Решение**: Добавлен `z-index: 99999 !important` для всех элементов TON Connect
- **Результат**: Теперь можно нормально подключить кошелек

### ✅ 3. Убраны надписи с карты
- **Удалено**: "YOUR BALANCE" и "MTV" с карты MC Bank
- **Оставлено**: Только символ ɱ и сумма
- **Дизайн**: Баланс теперь по центру карты, кнопка на всю ширину

### ✅ 4. Переименование
- **Было**: "MↃREW Design Studio"
- **Стало**: "MCREW"
- **Где**: Title страницы, все упоминания

## Технические детали:

### USDT Checker API:
```javascript
// TronScan API endpoint
https://apilist.tronscanapi.com/api/token_trc20/transfers

// Parameters:
- relatedAddress: TJDENsfBJs4RFETt1X1W8wMDc8M5XnJhCe
- contract_address: TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t (USDT TRC-20)
- limit: 20
```

### Функции:
- `checkUSDTTransactions()` - проверяет новые транзакции
- `startUSDTChecker()` - запускает проверку каждые 30 сек
- `saveTransaction()` - сохраняет транзакцию в API

### localStorage ключи:
- `last_usdt_check_{userId}` - timestamp последней проверки
- `mcrew_balance_{userId}` - баланс пользователя

## Что нужно для работы:

1. **Worker API** должен поддерживать:
   - `POST /api/transactions` - сохранение транзакций
   - `GET /api/user/{id}/balance` - получение баланса
   - `POST /api/user/{id}/balance` - обновление баланса

2. **TronScan API** - публичный, не требует ключей

## Тестирование:

1. Отправь тестовую транзакцию USDT (TRC-20) на адрес
2. Подожди до 30 секунд
3. Баланс должен автоматически обновиться
4. Появится уведомление о зачислении

## Примечания:

- Проверка работает только когда пользователь авторизован
- Транзакции проверяются только подтвержденные (`confirmed: true`)
- Дубликаты исключаются через timestamp
- Если API недоступен, проверка продолжится при следующей попытке
