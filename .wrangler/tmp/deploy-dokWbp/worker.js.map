{
  "version": 3,
  "sources": ["../../../worker.js"],
  "sourceRoot": "C:\\Users\\gelin\\OneDrive\\\u0420\u0430\u0431\u043E\u0447\u0438\u0439 \u0441\u0442\u043E\u043B\\\u0434\u0438\u0437\u0430\u0439\u043D\u0435\u0440\u0441\u043A\u0430\u044F \u043F\u043E\u0435\u0431\u043E\u0442\u0430\\.wrangler\\tmp\\deploy-dokWbp",
  "sourcesContent": ["/**\r\n * MCREW Telegram Bot - Cloudflare Workers Version\r\n * Fast, reliable, never goes down\r\n */\r\n\r\n// Admin user ID\r\nconst ADMIN_USER_ID = 8017281019;\r\n\r\nexport default {\r\n  async fetch(request, env, ctx) {\r\n    return handleRequest(request, env)\r\n  }\r\n}\r\n\r\n// Language system - store in KV or memory\r\nconst userLanguages = new Map()\r\n\r\n// Texts in different languages\r\nconst TEXTS = {\r\n  en: {\r\n    welcome: `\uD83D\uDD25 <b>Welcome to MCREW!</b>\r\n\r\nWe create:\r\n\u2022 Covers, snippets, visuals\r\n\u2022 VFX and motion graphics  \r\n\u2022 Brand identity and logos\r\n\u2022 UI/UX design\r\n\u2022 Print materials\r\n\u2022 Video editing\r\n\r\n<b>Choose what interests you:</b>`,\r\n    menu_title: `\uD83D\uDD25 <b>MCREW</b>\r\n\r\n<b>Choose what interests you:</b>`,\r\n    graphic_design: '\uD83C\uDFA8 Graphic Design',\r\n    ui_design: '\uD83D\uDCF1 UI/UX Design', \r\n    print: '\uD83D\uDCC4 Print/Publishing',\r\n    vfx: '\uD83C\uDFAC Editing & VFX',\r\n    motion: '\uD83C\uDFAD Motion Design',\r\n    portfolio: '\uD83D\uDCBC Portfolio',\r\n    contact: '\uD83D\uDCDE Contact',\r\n    language: '\uD83C\uDF10 Language',\r\n    back: '\u25C0\uFE0F Back to Menu',\r\n    order_thanks: `\u2705 <b>Thank you for your order!</b>\r\n\r\nWe received your message and will contact you within 2 hours.\r\n\r\n\uD83D\uDCAC Questions? Write @mcrewdm`,\r\n    new_order: `\uD83D\uDD14 <b>NEW ORDER!</b>\r\n\r\n\uD83D\uDC64 <b>Client:</b> {name} (@{username})\r\n\r\n\uD83D\uDCDD <b>Message:</b>\r\n{message}\r\n\r\n\u23F0 <b>Time:</b> {time}`,\r\n    order_logo: '\uD83C\uDFAF Order Logo',\r\n    order_brand: '\uD83C\uDFAF Order Brand Identity',\r\n    order_book: '\uD83C\uDFAF Order Brandbook',\r\n    order_icon: '\uD83C\uDFAF Order Icon',\r\n    order_illustration: '\uD83C\uDFAF Order Illustration',\r\n    order_landing: '\uD83C\uDFAF Order Landing Page',\r\n    order_website: '\uD83C\uDFAF Order Website',\r\n    order_mobile: '\uD83C\uDFAF Order Mobile Screen',\r\n    order_fullui: '\uD83C\uDFAF Order Full Mobile UI',\r\n    order_card: '\uD83C\uDFAF Order Business Card',\r\n    order_presentation: '\uD83C\uDFAF Order Presentation',\r\n    order_monthly: '\uD83C\uDFAF Order Monthly Package',\r\n    order_short: '\uD83C\uDFAF Order Short Video Edit',\r\n    order_medium: '\uD83C\uDFAF Order Medium Video Edit',\r\n    order_long: '\uD83C\uDFAF Order Long Video Edit',\r\n    order_ccsfx: '\uD83C\uDFAF Order CC/SFX',\r\n    order_logoanim: '\uD83C\uDFAF Order Logo Animation',\r\n    order_2danim: '\uD83C\uDFAF Order 2D Animation',\r\n    order_promo: '\uD83C\uDFAF Order Promo Video',\r\n    order_event: '\uD83C\uDFAF Order Event Visuals',\r\n    order_form: `\uD83D\uDED2 <b>ORDER: {service_name}</b>\r\n\r\nTo create the perfect design, please provide:\r\n\r\n\uD83D\uDCDD <b>PROJECT DETAILS:</b>\r\n\u2022 What exactly do you need?\r\n\u2022 Purpose/goal of the design\r\n\r\n\uD83C\uDFA8 <b>STYLE & COLORS:</b>\r\n\u2022 Preferred style (minimal, dark, colorful, etc.)\r\n\u2022 Main colors you want\r\n\u2022 Colors to avoid\r\n\r\n\uD83D\uDCCF <b>REQUIREMENTS:</b>\r\n\u2022 Format/size needed\r\n\u2022 Where will it be used?\r\n\u2022 Any text/brand name to include\r\n\r\n\u23F0 <b>TIMELINE & BUDGET:</b>\r\n\u2022 When do you need it?\r\n\u2022 Your budget range\r\n\u2022 Urgent? (+50% for \u22644 days)\r\n\r\n\uD83D\uDCCE <b>REFERENCES:</b>\r\n\u2022 Send inspiration images/links\r\n\u2022 Any specific requirements\r\n\r\n\uD83D\uDCA1 <b>Write all details in your next message!</b>`,\r\n  },\r\n  ru: {\r\n    welcome: `\uD83D\uDD25 <b>\u0414\u043E\u0431\u0440\u043E \u043F\u043E\u0436\u0430\u043B\u043E\u0432\u0430\u0442\u044C \u0432 MCREW!</b>\r\n\r\n\u041C\u044B \u0441\u043E\u0437\u0434\u0430\u0435\u043C:\r\n\u2022 \u041E\u0431\u043B\u043E\u0436\u043A\u0438, \u0441\u043D\u0438\u043F\u043F\u0435\u0442\u044B, \u0432\u0438\u0437\u0443\u0430\u043B\u044B\r\n\u2022 VFX \u0438 \u043C\u043E\u0443\u0448\u043D \u0433\u0440\u0430\u0444\u0438\u043A\u0443\r\n\u2022 \u0424\u0438\u0440\u043C\u0435\u043D\u043D\u044B\u0439 \u0441\u0442\u0438\u043B\u044C \u0438 \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u044B\r\n\u2022 UI/UX \u0434\u0438\u0437\u0430\u0439\u043D\r\n\u2022 \u041F\u0435\u0447\u0430\u0442\u043D\u044B\u0435 \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044B\r\n\u2022 \u0412\u0438\u0434\u0435\u043E\u043C\u043E\u043D\u0442\u0430\u0436\r\n\r\n<b>\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0442\u043E \u0432\u0430\u0441 \u0438\u043D\u0442\u0435\u0440\u0435\u0441\u0443\u0435\u0442:</b>`,\r\n    menu_title: `\uD83D\uDD25 <b>MCREW</b>\r\n\r\n<b>\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0447\u0442\u043E \u0432\u0430\u0441 \u0438\u043D\u0442\u0435\u0440\u0435\u0441\u0443\u0435\u0442:</b>`,\r\n    graphic_design: '\uD83C\uDFA8 \u0413\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u0434\u0438\u0437\u0430\u0439\u043D',\r\n    ui_design: '\uD83D\uDCF1 UI/UX \u0434\u0438\u0437\u0430\u0439\u043D',\r\n    print: '\uD83D\uDCC4 \u041F\u0435\u0447\u0430\u0442\u044C/\u0418\u0437\u0434\u0430\u0442\u0435\u043B\u044C\u0441\u0442\u0432\u043E', \r\n    vfx: '\uD83C\uDFAC \u041C\u043E\u043D\u0442\u0430\u0436 \u0438 VFX',\r\n    motion: '\uD83C\uDFAD \u041C\u043E\u0443\u0448\u043D \u0434\u0438\u0437\u0430\u0439\u043D',\r\n    portfolio: '\uD83D\uDCBC \u041F\u043E\u0440\u0442\u0444\u043E\u043B\u0438\u043E',\r\n    contact: '\uD83D\uDCDE \u041A\u043E\u043D\u0442\u0430\u043A\u0442\u044B',\r\n    language: '\uD83C\uDF10 \u042F\u0437\u044B\u043A',\r\n    back: '\u25C0\uFE0F \u041D\u0430\u0437\u0430\u0434 \u0432 \u043C\u0435\u043D\u044E',\r\n    order_thanks: `\u2705 <b>\u0421\u043F\u0430\u0441\u0438\u0431\u043E \u0437\u0430 \u0432\u0430\u0448 \u0437\u0430\u043A\u0430\u0437!</b>\r\n\r\n\u041C\u044B \u043F\u043E\u043B\u0443\u0447\u0438\u043B\u0438 \u0432\u0430\u0448\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0438 \u0441\u0432\u044F\u0436\u0435\u043C\u0441\u044F \u0441 \u0432\u0430\u043C\u0438 \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 2 \u0447\u0430\u0441\u043E\u0432.\r\n\r\n\uD83D\uDCAC \u0412\u043E\u043F\u0440\u043E\u0441\u044B? \u041F\u0438\u0448\u0438\u0442\u0435 @mcrewdm`,\r\n    new_order: `\uD83D\uDD14 <b>\u041D\u041E\u0412\u042B\u0419 \u0417\u0410\u041A\u0410\u0417!</b>\r\n\r\n\uD83D\uDC64 <b>\u041A\u043B\u0438\u0435\u043D\u0442:</b> {name} (@{username})\r\n\r\n\uD83D\uDCDD <b>\u0421\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435:</b>\r\n{message}\r\n\r\n\u23F0 <b>\u0412\u0440\u0435\u043C\u044F:</b> {time}`,\r\n    order_logo: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u043B\u043E\u0433\u043E\u0442\u0438\u043F',\r\n    order_brand: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0444\u0438\u0440\u043C\u0435\u043D\u043D\u044B\u0439 \u0441\u0442\u0438\u043B\u044C',\r\n    order_book: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0431\u0440\u0435\u043D\u0434\u0431\u0443\u043A',\r\n    order_icon: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0438\u043A\u043E\u043D\u043A\u0443',\r\n    order_illustration: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0438\u043B\u043B\u044E\u0441\u0442\u0440\u0430\u0446\u0438\u044E',\r\n    order_landing: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u043B\u0435\u043D\u0434\u0438\u043D\u0433',\r\n    order_website: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u0430\u0439\u0442',\r\n    order_mobile: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u044D\u043A\u0440\u0430\u043D \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F',\r\n    order_fullui: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u043E\u043B\u043D\u044B\u0439 UI',\r\n    order_card: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0438\u0437\u0438\u0442\u043A\u0443',\r\n    order_presentation: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u0440\u0435\u0437\u0435\u043D\u0442\u0430\u0446\u0438\u044E',\r\n    order_monthly: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u043C\u0435\u0441\u044F\u0447\u043D\u044B\u0439 \u043F\u0430\u043A\u0435\u0442',\r\n    order_short: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u043A\u043E\u0440\u043E\u0442\u043A\u0438\u0439 \u043C\u043E\u043D\u0442\u0430\u0436',\r\n    order_medium: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0441\u0440\u0435\u0434\u043D\u0438\u0439 \u043C\u043E\u043D\u0442\u0430\u0436',\r\n    order_long: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0434\u043B\u0438\u043D\u043D\u044B\u0439 \u043C\u043E\u043D\u0442\u0430\u0436',\r\n    order_ccsfx: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0446\u0432\u0435\u0442\u043E\u043A\u043E\u0440/\u0437\u0432\u0443\u043A',\r\n    order_logoanim: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E \u043B\u043E\u0433\u043E',\r\n    order_2danim: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C 2D \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E',\r\n    order_promo: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u0440\u043E\u043C\u043E \u0432\u0438\u0434\u0435\u043E',\r\n    order_event: '\uD83C\uDFAF \u0417\u0430\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0438\u0437\u0443\u0430\u043B\u044B \u0434\u043B\u044F \u0441\u043E\u0431\u044B\u0442\u0438\u0439',\r\n    order_form: `\uD83D\uDED2 <b>\u0417\u0410\u041A\u0410\u0417: {service_name}</b>\r\n\r\n\u0427\u0442\u043E\u0431\u044B \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0438\u0434\u0435\u0430\u043B\u044C\u043D\u044B\u0439 \u0434\u0438\u0437\u0430\u0439\u043D, \u0443\u043A\u0430\u0436\u0438\u0442\u0435:\r\n\r\n\uD83D\uDCDD <b>\u0414\u0415\u0422\u0410\u041B\u0418 \u041F\u0420\u041E\u0415\u041A\u0422\u0410:</b>\r\n\u2022 \u0427\u0442\u043E \u0438\u043C\u0435\u043D\u043D\u043E \u0432\u0430\u043C \u043D\u0443\u0436\u043D\u043E?\r\n\u2022 \u0426\u0435\u043B\u044C/\u043D\u0430\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u0434\u0438\u0437\u0430\u0439\u043D\u0430\r\n\r\n\uD83C\uDFA8 <b>\u0421\u0422\u0418\u041B\u042C \u0418 \u0426\u0412\u0415\u0422\u0410:</b>\r\n\u2022 \u041F\u0440\u0435\u0434\u043F\u043E\u0447\u0438\u0442\u0430\u0435\u043C\u044B\u0439 \u0441\u0442\u0438\u043B\u044C (\u043C\u0438\u043D\u0438\u043C\u0430\u043B\u0438\u0437\u043C, \u0442\u0435\u043C\u043D\u044B\u0439, \u044F\u0440\u043A\u0438\u0439 \u0438 \u0442.\u0434.)\r\n\u2022 \u041E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 \u0446\u0432\u0435\u0442\u0430\r\n\u2022 \u0426\u0432\u0435\u0442\u0430, \u043A\u043E\u0442\u043E\u0440\u044B\u0445 \u0441\u043B\u0435\u0434\u0443\u0435\u0442 \u0438\u0437\u0431\u0435\u0433\u0430\u0442\u044C\r\n\r\n\uD83D\uDCCF <b>\u0422\u0420\u0415\u0411\u041E\u0412\u0410\u041D\u0418\u042F:</b>\r\n\u2022 \u041D\u0443\u0436\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442/\u0440\u0430\u0437\u043C\u0435\u0440\r\n\u2022 \u0413\u0434\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C\u0441\u044F?\r\n\u2022 \u0422\u0435\u043A\u0441\u0442/\u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0431\u0440\u0435\u043D\u0434\u0430 \u0434\u043B\u044F \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u044F\r\n\r\n\u23F0 <b>\u0421\u0420\u041E\u041A\u0418 \u0418 \u0411\u042E\u0414\u0416\u0415\u0422:</b>\r\n\u2022 \u041A\u043E\u0433\u0434\u0430 \u043D\u0443\u0436\u043D\u043E \u0433\u043E\u0442\u043E\u0432\u043E?\r\n\u2022 \u0412\u0430\u0448 \u0431\u044E\u0434\u0436\u0435\u0442\r\n\u2022 \u0421\u0440\u043E\u0447\u043D\u043E? (+50% \u0437\u0430 \u22644 \u0434\u043D\u044F)\r\n\r\n\uD83D\uDCCE <b>\u0420\u0415\u0424\u0415\u0420\u0415\u041D\u0421\u042B:</b>\r\n\u2022 \u041F\u0440\u0438\u0448\u043B\u0438\u0442\u0435 \u043F\u0440\u0438\u043C\u0435\u0440\u044B/\u0441\u0441\u044B\u043B\u043A\u0438 \u0434\u043B\u044F \u0432\u0434\u043E\u0445\u043D\u043E\u0432\u0435\u043D\u0438\u044F\r\n\u2022 \u041E\u0441\u043E\u0431\u044B\u0435 \u0442\u0440\u0435\u0431\u043E\u0432\u0430\u043D\u0438\u044F\r\n\r\n\uD83D\uDCA1 <b>\u041D\u0430\u043F\u0438\u0448\u0438\u0442\u0435 \u0432\u0441\u0435 \u0434\u0435\u0442\u0430\u043B\u0438 \u0432 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0438!</b>`,\r\n  }\r\n}\r\n\r\n// Helper functions\r\nfunction getUserLanguage(userId) {\r\n  return userLanguages.get(userId) || 'en'\r\n}\r\n\r\nfunction setUserLanguage(userId, lang) {\r\n  userLanguages.set(userId, lang)\r\n}\r\n\r\nfunction getText(userId, key, params = {}) {\r\n  const lang = getUserLanguage(userId)\r\n  let text = TEXTS[lang]?.[key] || TEXTS.en[key] || key\r\n  \r\n  // Replace parameters\r\n  Object.keys(params).forEach(k => {\r\n    text = text.replace(`{${k}}`, params[k])\r\n  })\r\n  \r\n  return text\r\n}\r\n\r\nasync function sendPhoto(chatId, photoUrl, caption = '', replyMarkup = null, token) {\r\n  const url = `https://api.telegram.org/bot${token}/sendPhoto`\r\n  const body = {\r\n    chat_id: chatId,\r\n    photo: photoUrl,\r\n    caption: caption,\r\n    parse_mode: 'HTML'\r\n  }\r\n  \r\n  if (replyMarkup) {\r\n    body.reply_markup = replyMarkup\r\n  }\r\n  \r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(body)\r\n  })\r\n  \r\n  return await response.json()\r\n}\r\n\r\nasync function sendVideo(chatId, videoUrl, caption = '', replyMarkup = null, token) {\r\n  const url = `https://api.telegram.org/bot${token}/sendVideo`\r\n  const body = {\r\n    chat_id: chatId,\r\n    video: videoUrl,\r\n    caption: caption,\r\n    parse_mode: 'HTML'\r\n  }\r\n  \r\n  if (replyMarkup) {\r\n    body.reply_markup = replyMarkup\r\n  }\r\n  \r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(body)\r\n  })\r\n  \r\n  return await response.json()\r\n}\r\n\r\nasync function deleteMessage(chatId, messageId, token) {\r\n  const url = `https://api.telegram.org/bot${token}/deleteMessage`\r\n  const body = {\r\n    chat_id: chatId,\r\n    message_id: messageId\r\n  }\r\n  \r\n  await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(body)\r\n  })\r\n}\r\n\r\nasync function editMessageMedia(chatId, messageId, photoFileId, caption, replyMarkup, token) {\r\n  const url = `https://api.telegram.org/bot${token}/editMessageMedia`\r\n  const body = {\r\n    chat_id: chatId,\r\n    message_id: messageId,\r\n    media: {\r\n      type: 'photo',\r\n      media: photoFileId,\r\n      caption: caption,\r\n      parse_mode: 'HTML'\r\n    }\r\n  }\r\n  \r\n  if (replyMarkup) {\r\n    body.reply_markup = replyMarkup\r\n  }\r\n  \r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(body)\r\n  })\r\n  \r\n  return await response.json()\r\n}\r\n\r\n// Telegram API functions\r\nasync function sendMessage(chatId, text, replyMarkup = null, token) {\r\n  const url = `https://api.telegram.org/bot${token}/sendMessage`\r\n  const body = {\r\n    chat_id: chatId,\r\n    text: text,\r\n    parse_mode: 'HTML'\r\n  }\r\n  \r\n  if (replyMarkup) {\r\n    body.reply_markup = replyMarkup\r\n  }\r\n  \r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(body)\r\n  })\r\n  \r\n  return await response.json()\r\n}\r\n\r\nasync function editMessageText(chatId, messageId, text, replyMarkup = null, token) {\r\n  const url = `https://api.telegram.org/bot${token}/editMessageText`\r\n  const body = {\r\n    chat_id: chatId,\r\n    message_id: messageId,\r\n    text: text,\r\n    parse_mode: 'HTML'\r\n  }\r\n  \r\n  if (replyMarkup) {\r\n    body.reply_markup = replyMarkup\r\n  }\r\n  \r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(body)\r\n  })\r\n  \r\n  return await response.json()\r\n}\r\n\r\nasync function answerCallbackQuery(callbackQueryId, token) {\r\n  const url = `https://api.telegram.org/bot${token}/answerCallbackQuery`\r\n  await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ callback_query_id: callbackQueryId })\r\n  })\r\n}\r\n\r\n// Keyboard builders\r\nfunction getMainMenuKeyboard(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  return {\r\n    inline_keyboard: [\r\n      [{ text: TEXTS[lang].graphic_design, callback_data: 'cat_graphic' }],\r\n      [{ text: TEXTS[lang].ui_design, callback_data: 'cat_ui' }],\r\n      [{ text: TEXTS[lang].print, callback_data: 'cat_print' }],\r\n      [{ text: TEXTS[lang].vfx, callback_data: 'cat_vfx' }],\r\n      [{ text: TEXTS[lang].motion, callback_data: 'cat_motion' }],\r\n      [{ text: TEXTS[lang].portfolio, callback_data: 'show_portfolio' }],\r\n      [{ text: TEXTS[lang].contact, callback_data: 'show_contact' }],\r\n      [{ text: TEXTS[lang].language, callback_data: 'show_language' }]\r\n    ]\r\n  }\r\n}\r\n\r\n// Category handlers\r\nfunction handleGraphicDesign(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const text = lang === 'ru' \r\n    ? `\uD83C\uDFA8 <b>\u0413\u0420\u0410\u0424\u0418\u0427\u0415\u0421\u041A\u0418\u0419 \u0414\u0418\u0417\u0410\u0419\u041D</b>\r\n\r\n<b>\u041B\u043E\u0433\u043E\u0442\u0438\u043F</b> \u2014 \u20AC110-180\r\n<b>\u0424\u0438\u0440\u043C\u0435\u043D\u043D\u044B\u0439 \u0441\u0442\u0438\u043B\u044C</b> (\u043B\u043E\u0433\u043E\u0442\u0438\u043F, \u0446\u0432\u0435\u0442\u0430, \u0442\u0438\u043F\u043E\u0433\u0440\u0430\u0444\u0438\u043A\u0430) \u2014 \u20AC270-550\r\n<b>\u041F\u043E\u043B\u043D\u044B\u0439 \u0431\u0440\u0435\u043D\u0434\u0431\u0443\u043A</b> \u2014 \u20AC550-1100\r\n<b>\u0418\u043A\u043E\u043D\u043A\u0430</b> (1 \u0448\u0442.) \u2014 \u20AC9-22\r\n<b>\u041F\u0440\u043E\u0441\u0442\u0430\u044F \u0438\u043B\u043B\u044E\u0441\u0442\u0440\u0430\u0446\u0438\u044F</b> (\u043E\u0431\u043B\u043E\u0436\u043A\u0438 \u0438 \u0442.\u0434.) \u2014 \u20AC45-90\r\n<b>\u0414\u0435\u0442\u0430\u043B\u044C\u043D\u0430\u044F \u0438\u043B\u043B\u044E\u0441\u0442\u0440\u0430\u0446\u0438\u044F</b> (\u043E\u0431\u043B\u043E\u0436\u043A\u0438 \u0438 \u0442.\u0434.) \u2014 \u20AC110-230\r\n\r\n<i>\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043B\u0443\u0433\u0443 \u0434\u043B\u044F \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u0430</i>`\r\n    : `\uD83C\uDFA8 <b>GRAPHIC DESIGN</b>\r\n\r\n<b>Logo</b> \u2014 \u20AC110-180\r\n<b>Brand identity</b> (logo, colors, typography) \u2014 \u20AC270-550\r\n<b>Full brandbook</b> \u2014 \u20AC550-1100\r\n<b>Icon</b> (1 pc.) \u2014 \u20AC9-22\r\n<b>Simple illustration</b> (cover art, etc.) \u2014 \u20AC45-90\r\n<b>Detailed illustration</b> (cover art, etc.) \u2014 \u20AC110-230\r\n\r\n<i>Choose a service to place an order</i>`\r\n\r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: getText(userId, 'order_logo'), callback_data: 'ord_logo' }],\r\n      [{ text: getText(userId, 'order_brand'), callback_data: 'ord_brand' }],\r\n      [{ text: getText(userId, 'order_book'), callback_data: 'ord_book' }],\r\n      [{ text: getText(userId, 'order_icon'), callback_data: 'ord_icon' }],\r\n      [{ text: getText(userId, 'order_illustration'), callback_data: 'ord_illust' }],\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.pricelist }\r\n}\r\n\r\nfunction handleUIDesign(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const text = lang === 'ru'\r\n    ? `\uD83D\uDCF1 <b>UI/UX \u0414\u0418\u0417\u0410\u0419\u041D</b>\r\n\r\n<b>\u041B\u0435\u043D\u0434\u0438\u043D\u0433</b> (1 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430) \u2014 \u20AC140-280\r\n<b>\u041C\u043D\u043E\u0433\u043E\u0441\u0442\u0440\u0430\u043D\u0438\u0447\u043D\u044B\u0439 \u0441\u0430\u0439\u0442</b> (5-7 \u0441\u0442\u0440\u0430\u043D\u0438\u0446) \u2014 \u20AC460-850\r\n\r\n<b>\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u043E\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435</b> (1 \u044D\u043A\u0440\u0430\u043D) \u2014 \u20AC28-55\r\n<b>\u041F\u043E\u043B\u043D\u044B\u0439 UI \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F</b> (10-15 \u044D\u043A\u0440\u0430\u043D\u043E\u0432) \u2014 \u20AC370-850\r\n\r\n<i>\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043B\u0443\u0433\u0443 \u0434\u043B\u044F \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u0430</i>`\r\n    : `\uD83D\uDCF1 <b>UI/UX DESIGN</b>\r\n\r\n<b>Landing page</b> (1 page) \u2014 \u20AC140-280\r\n<b>Multi-page website</b> (5-7 pages) \u2014 \u20AC460-850\r\n\r\n<b>Mobile app</b> (single screen) \u2014 \u20AC28-55\r\n<b>Mobile app full UI</b> (10-15 screens) \u2014 \u20AC370-850\r\n\r\n<i>Choose a service to place an order</i>`\r\n  \r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: getText(userId, 'order_landing'), callback_data: 'ord_landing' }],\r\n      [{ text: getText(userId, 'order_website'), callback_data: 'ord_website' }],\r\n      [{ text: getText(userId, 'order_mobile'), callback_data: 'ord_mobile' }],\r\n      [{ text: getText(userId, 'order_fullui'), callback_data: 'ord_fullui' }],\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.pricelist }\r\n}\r\n\r\nfunction handlePrint(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const text = lang === 'ru'\r\n    ? `\uD83D\uDCC4 <b>\u041F\u0415\u0427\u0410\u0422\u042C / \u0418\u0417\u0414\u0410\u0422\u0415\u041B\u042C\u0421\u0422\u0412\u041E</b>\r\n\r\n<b>\u0412\u0438\u0437\u0438\u0442\u043A\u0430</b> \u2014 \u20AC13-22\r\n<b>\u041F\u0440\u0435\u0437\u0435\u043D\u0442\u0430\u0446\u0438\u044F</b> (1 \u0441\u043B\u0430\u0439\u0434) \u2014 \u20AC7-14\r\n<b>\u041F\u043E\u043B\u043D\u0430\u044F \u043F\u0440\u0435\u0437\u0435\u043D\u0442\u0430\u0446\u0438\u044F</b> (10-20 \u0441\u043B\u0430\u0439\u0434\u043E\u0432) \u2014 \u20AC70-165\r\n<b>\u041C\u0435\u0441\u044F\u0447\u043D\u044B\u0439 \u043F\u0430\u043A\u0435\u0442</b> (8-12 \u043F\u043E\u0441\u0442\u043E\u0432 + \u0441\u0442\u043E\u0440\u0438\u0441) \u2014 \u20AC130-195\r\n\r\n<i>\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043B\u0443\u0433\u0443 \u0434\u043B\u044F \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u0430</i>`\r\n    : `\uD83D\uDCC4 <b>PRINT / PUBLISHING</b>\r\n\r\n<b>Business card</b> \u2014 \u20AC13-22\r\n<b>Presentation</b> (1 slide) \u2014 \u20AC7-14\r\n<b>Full presentation</b> (10-20 slides) \u2014 \u20AC70-165\r\n<b>Monthly package</b> (8-12 posts + stories) \u2014 \u20AC130-195\r\n\r\n<i>Choose a service to place an order</i>`\r\n\r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: getText(userId, 'order_card'), callback_data: 'ord_card' }],\r\n      [{ text: getText(userId, 'order_presentation'), callback_data: 'ord_present' }],\r\n      [{ text: getText(userId, 'order_monthly'), callback_data: 'ord_monthly' }],\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.pricelist }\r\n}\r\n\r\nfunction handleVFX(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const text = lang === 'ru'\r\n    ? `\uD83C\uDFAC <b>\u041C\u041E\u041D\u0422\u0410\u0416 \u0418 VFX</b>\r\n\r\n<b>\u0412\u0438\u0434\u0435\u043E\u043C\u043E\u043D\u0442\u0430\u0436</b> (\u0434\u043E 1 \u043C\u0438\u043D) \u2014 \u20AC40-60\r\n<b>\u0412\u0438\u0434\u0435\u043E\u043C\u043E\u043D\u0442\u0430\u0436</b> (\u0434\u043E 5 \u043C\u0438\u043D) \u2014 \u20AC80-200\r\n<b>\u0412\u0438\u0434\u0435\u043E\u043C\u043E\u043D\u0442\u0430\u0436</b> (5-15 \u043C\u0438\u043D) \u2014 \u20AC200-350\r\n<b>\u0426\u0432\u0435\u0442\u043E\u043A\u043E\u0440\u0440\u0435\u043A\u0446\u0438\u044F / \u0417\u0432\u0443\u043A</b> \u2014 \u20AC15-25\r\n\r\n<i>\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043B\u0443\u0433\u0443 \u0434\u043B\u044F \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u0430</i>`\r\n    : `\uD83C\uDFAC <b>EDITING & VFX</b>\r\n\r\n<b>Video editing</b> (up to 1 min) \u2014 \u20AC40-60\r\n<b>Video editing</b> (up to 5 min) \u2014 \u20AC80-200\r\n<b>Video editing</b> (5-15 min) \u2014 \u20AC200-350\r\n<b>CC / SFX</b> \u2014 \u20AC15-25\r\n\r\n<i>Choose a service to place an order</i>`\r\n  \r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: getText(userId, 'order_short'), callback_data: 'ord_short' }],\r\n      [{ text: getText(userId, 'order_medium'), callback_data: 'ord_medium' }],\r\n      [{ text: getText(userId, 'order_long'), callback_data: 'ord_long' }],\r\n      [{ text: getText(userId, 'order_ccsfx'), callback_data: 'ord_ccsfx' }],\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.pricelist }\r\n}\r\n\r\nfunction handleMotion(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const text = lang === 'ru'\r\n    ? `\uD83C\uDFAD <b>\u041C\u041E\u0423\u0428\u041D \u0414\u0418\u0417\u0410\u0419\u041D</b>\r\n\r\n<b>\u0410\u043D\u0438\u043C\u0430\u0446\u0438\u044F \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u0430</b> \u2014 \u20AC80\r\n<b>\u041F\u0440\u043E\u0441\u0442\u0430\u044F 2D \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044F</b> (10-20 \u0441\u0435\u043A) \u2014 \u20AC70-80\r\n<b>\u0420\u0435\u043A\u043B\u0430\u043C\u043D\u0430\u044F \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044F</b> (\u0434\u043E 30 \u0441\u0435\u043A) \u2014 \u20AC100-150\r\n<b>\u0412\u0438\u0437\u0443\u0430\u043B\u044B \u0434\u043B\u044F \u0441\u043E\u0431\u044B\u0442\u0438\u0439</b> \u2014 \u043E\u0442 \u20AC120\r\n\r\n<i>\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0441\u043B\u0443\u0433\u0443 \u0434\u043B\u044F \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u0430</i>`\r\n    : `\uD83C\uDFAD <b>MOTION DESIGN</b>\r\n\r\n<b>Logo animation</b> \u2014 \u20AC80\r\n<b>Simple 2D animation</b> (10-20 sec) \u2014 \u20AC70-80\r\n<b>Promo/advertising animation</b> (up to 30 sec) \u2014 \u20AC100-150\r\n<b>Event screens/visuals</b> \u2014 from \u20AC120\r\n\r\n<i>Choose a service to place an order</i>`\r\n\r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: getText(userId, 'order_logoanim'), callback_data: 'ord_logoanim' }],\r\n      [{ text: getText(userId, 'order_2danim'), callback_data: 'ord_2danim' }],\r\n      [{ text: getText(userId, 'order_promo'), callback_data: 'ord_promo' }],\r\n      [{ text: getText(userId, 'order_event'), callback_data: 'ord_event' }],\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.pricelist }\r\n}\r\n\r\nfunction handlePortfolio(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const text = lang === 'ru'\r\n    ? `\uD83D\uDCBC <b>\u041F\u041E\u0420\u0422\u0424\u041E\u041B\u0418\u041E</b>\r\n\r\n\uD83D\uDCF8 <b>\u041A\u0430\u043D\u0430\u043B:</b> @mindescrew\r\n\r\n\uD83D\uDD25 <b>\u041F\u0440\u0438\u043C\u0435\u0440\u044B \u043D\u0430\u0448\u0438\u0445 \u0440\u0430\u0431\u043E\u0442:</b>\r\n\u2022 \u041E\u0431\u043B\u043E\u0436\u043A\u0438 \u0430\u043B\u044C\u0431\u043E\u043C\u043E\u0432 \u0438 \u0430\u0440\u0442\u0432\u043E\u0440\u043A\u0438\r\n\u2022 \u0424\u0438\u0440\u043C\u0435\u043D\u043D\u044B\u0435 \u0441\u0442\u0438\u043B\u0438 \u0438 \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u044B\r\n\u2022 UI/UX \u0434\u0438\u0437\u0430\u0439\u043D\r\n\u2022 \u041C\u043E\u0443\u0448\u043D \u0433\u0440\u0430\u0444\u0438\u043A\u0430 \u0438 VFX\r\n\u2022 \u041A\u043E\u043D\u0442\u0435\u043D\u0442 \u0434\u043B\u044F \u0441\u043E\u0446\u0438\u0430\u043B\u044C\u043D\u044B\u0445 \u0441\u0435\u0442\u0435\u0439\r\n\u2022 \u041F\u0435\u0447\u0430\u0442\u043D\u044B\u0435 \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u044B\r\n\r\n\uD83D\uDCA1 \u041A\u0430\u0436\u0434\u044B\u0439 \u043F\u0440\u043E\u0435\u043A\u0442 \u0443\u043D\u0438\u043A\u0430\u043B\u0435\u043D \u0438 \u0441\u043E\u0437\u0434\u0430\u0435\u0442\u0441\u044F \u043F\u043E\u0434 \u0432\u0430\u0448\u0438 \u043F\u043E\u0442\u0440\u0435\u0431\u043D\u043E\u0441\u0442\u0438!\r\n\r\n\uD83D\uDCDE \u0421\u0432\u044F\u0436\u0438\u0442\u0435\u0441\u044C \u0441 \u043D\u0430\u043C\u0438, \u0447\u0442\u043E\u0431\u044B \u0443\u0432\u0438\u0434\u0435\u0442\u044C \u043A\u043E\u043D\u043A\u0440\u0435\u0442\u043D\u044B\u0435 \u043F\u0440\u0438\u043C\u0435\u0440\u044B \u0434\u043B\u044F \u0432\u0430\u0448\u0435\u0433\u043E \u0442\u0438\u043F\u0430 \u043F\u0440\u043E\u0435\u043A\u0442\u0430.`\r\n    : `\uD83D\uDCBC <b>OUR PORTFOLIO</b>\r\n\r\n\uD83D\uDCF8 <b>Channel:</b> @mindescrew\r\n\r\n\uD83D\uDD25 <b>Recent work examples:</b>\r\n\u2022 Album covers and artwork\r\n\u2022 Brand identities and logos\r\n\u2022 UI/UX designs\r\n\u2022 Motion graphics and VFX\r\n\u2022 Social media content\r\n\u2022 Print materials\r\n\r\n\uD83D\uDCA1 Each project is unique and tailored to your needs!\r\n\r\n\uD83D\uDCDE Contact us to see specific examples for your project type.`\r\n  \r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: lang === 'ru' ? '\uD83D\uDDBC\uFE0F \u041F\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u043F\u0440\u0438\u043C\u0435\u0440\u044B' : '\uD83D\uDDBC\uFE0F View Examples', callback_data: 'show_examples' }],\r\n      [{ text: lang === 'ru' ? '\uD83D\uDCDE \u0421\u0432\u044F\u0437\u0430\u0442\u044C\u0441\u044F \u0434\u043B\u044F \u0431\u043E\u043B\u044C\u0448\u0435 \u043F\u0440\u0438\u043C\u0435\u0440\u043E\u0432' : '\uD83D\uDCDE Contact for More Examples', callback_data: 'show_contact' }],\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.logo }\r\n}\r\n\r\nfunction handleContact(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const text = lang === 'ru'\r\n    ? `\uD83D\uDCDE <b>\u0421\u0412\u042F\u0417\u0410\u0422\u042C\u0421\u042F \u0421 \u041D\u0410\u041C\u0418</b>\r\n\r\n\uD83D\uDCAC <b>\u0422\u0435\u043B\u0435\u0433\u0440\u0430\u043C:</b> @mcrewdm\r\n\uD83C\uDF10 <b>\u041F\u043E\u0440\u0442\u0444\u043E\u043B\u0438\u043E:</b> @mindescrew\r\n\r\n\u23F0 <b>\u0420\u0430\u0431\u043E\u0447\u0438\u0435 \u0447\u0430\u0441\u044B:</b> \r\n\u041F\u043D-\u041F\u0442: 10:00 - 20:00 (UTC+3)\r\n\u0421\u0431-\u0412\u0441: 12:00 - 18:00 (UTC+3)\r\n\r\n\uD83D\uDCB0 <b>\u0421\u043F\u043E\u0441\u043E\u0431\u044B \u043E\u043F\u043B\u0430\u0442\u044B:</b>\r\n\u2022 PayPal \u2022 Bank transfer \u2022 Cryptocurrency\r\n\r\n\uD83D\uDCCB <b>\u0423\u0421\u041B\u041E\u0412\u0418\u042F:</b>\r\n\u2022 2 \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u044B\u0435 \u043F\u0440\u0430\u0432\u043A\u0438 \u2192 \u0434\u0430\u043B\u0435\u0435 \u20AC10 \u0437\u0430 \u043F\u0440\u0430\u0432\u043A\u0443\r\n\u2022 \u0421\u0440\u043E\u0447\u043D\u044B\u0439 \u0437\u0430\u043A\u0430\u0437 (\u2264 4 \u0434\u043D\u044F) \u2192 +50% \u043A \u0446\u0435\u043D\u0435\r\n\u2022 \u041F\u0435\u0440\u0435\u0434\u0435\u043B\u043A\u0430 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0435\u0439 \u0440\u0430\u0431\u043E\u0442\u044B \u2192 +30-50% \u043E\u0442 \u0431\u0430\u0437\u043E\u0432\u043E\u0439 \u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u0438\r\n\r\n\uD83D\uDCB1 <b>\u041A\u0443\u0440\u0441\u044B \u0432\u0430\u043B\u044E\u0442:</b>\r\n1\u20AC = 100\u20BD / 50\u20B4 | 1$ = 85\u20BD / 42\u20B4`\r\n    : `\uD83D\uDCDE <b>CONTACT US</b>\r\n\r\n\uD83D\uDCAC <b>Telegram:</b> @mcrewdm\r\n\uD83C\uDF10 <b>Portfolio:</b> @mindescrew\r\n\r\n\u23F0 <b>Working hours:</b>\r\nMon-Fri: 10:00 - 20:00 (UTC+3)\r\nSat-Sun: 12:00 - 18:00 (UTC+3)\r\n\r\n\uD83D\uDCB0 <b>Payment methods:</b>\r\n\u2022 PayPal \u2022 Bank transfer \u2022 Cryptocurrency\r\n\r\n\uD83D\uDCCB <b>TERMS:</b>\r\n\u2022 2 free revisions \u2192 afterward \u20AC10 per revision\r\n\u2022 Urgent order (\u2264 4 days) \u2192 +50% to the price\r\n\u2022 Redesign of existing work \u2192 +30-50% of base cost\r\n\r\n\uD83D\uDCB1 <b>Exchange rates:</b>\r\n1\u20AC = 100\u20BD / 50\u20B4 | 1$ = 85\u20BD / 42\u20B4`\r\n\r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.logo }\r\n}\r\n\r\nfunction handleLanguageMenu(userId) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const text = lang === 'ru'\r\n    ? `\uD83C\uDF10 <b>\u0412\u044B\u0431\u043E\u0440 \u044F\u0437\u044B\u043A\u0430</b>\r\n\r\n\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0440\u0435\u0434\u043F\u043E\u0447\u0438\u0442\u0430\u0435\u043C\u044B\u0439 \u044F\u0437\u044B\u043A:`\r\n    : `\uD83C\uDF10 <b>Language Selection</b>\r\n\r\nChoose your preferred language:`\r\n  \r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: '\uD83C\uDDFA\uD83C\uDDF8 English', callback_data: 'lang_en' }],\r\n      [{ text: '\uD83C\uDDF7\uD83C\uDDFA \u0420\u0443\u0441\u0441\u043A\u0438\u0439', callback_data: 'lang_ru' }],\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.logo }\r\n}\r\n\r\nfunction handleOrder(userId, service) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  const serviceNames = {\r\n    ord_logo: lang === 'en' ? 'Logo Design (\u20AC110-180)' : '\u041B\u043E\u0433\u043E\u0442\u0438\u043F (\u20AC110-180)',\r\n    ord_brand: lang === 'en' ? 'Brand Identity (\u20AC270-550)' : '\u0424\u0438\u0440\u043C\u0435\u043D\u043D\u044B\u0439 \u0441\u0442\u0438\u043B\u044C (\u20AC270-550)',\r\n    ord_book: lang === 'en' ? 'Full Brandbook (\u20AC550-1100)' : '\u041F\u043E\u043B\u043D\u044B\u0439 \u0431\u0440\u0435\u043D\u0434\u0431\u0443\u043A (\u20AC550-1100)',\r\n    ord_icon: lang === 'en' ? 'Icon Design (\u20AC9-22)' : '\u0414\u0438\u0437\u0430\u0439\u043D \u0438\u043A\u043E\u043D\u043A\u0438 (\u20AC9-22)',\r\n    ord_illust: lang === 'en' ? 'Illustration (\u20AC45-230)' : '\u0418\u043B\u043B\u044E\u0441\u0442\u0440\u0430\u0446\u0438\u044F (\u20AC45-230)',\r\n    ord_landing: lang === 'en' ? 'Landing Page (\u20AC140-280)' : '\u041B\u0435\u043D\u0434\u0438\u043D\u0433 (\u20AC140-280)',\r\n    ord_website: lang === 'en' ? 'Website (\u20AC460-850)' : '\u0421\u0430\u0439\u0442 (\u20AC460-850)',\r\n    ord_mobile: lang === 'en' ? 'Mobile Screen (\u20AC28-55)' : '\u042D\u043A\u0440\u0430\u043D \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F (\u20AC28-55)',\r\n    ord_fullui: lang === 'en' ? 'Mobile App UI (\u20AC370-850)' : '\u041F\u043E\u043B\u043D\u044B\u0439 UI \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F (\u20AC370-850)',\r\n    ord_card: lang === 'en' ? 'Business Card (\u20AC13-22)' : '\u0412\u0438\u0437\u0438\u0442\u043A\u0430 (\u20AC13-22)',\r\n    ord_present: lang === 'en' ? 'Presentation (\u20AC7-165)' : '\u041F\u0440\u0435\u0437\u0435\u043D\u0442\u0430\u0446\u0438\u044F (\u20AC7-165)',\r\n    ord_monthly: lang === 'en' ? 'Monthly Package (\u20AC130-195)' : '\u041C\u0435\u0441\u044F\u0447\u043D\u044B\u0439 \u043F\u0430\u043A\u0435\u0442 (\u20AC130-195)',\r\n    ord_short: lang === 'en' ? 'Short Video Edit (\u20AC40-60)' : '\u041A\u043E\u0440\u043E\u0442\u043A\u0438\u0439 \u043C\u043E\u043D\u0442\u0430\u0436 (\u20AC40-60)',\r\n    ord_medium: lang === 'en' ? 'Medium Video Edit (\u20AC80-200)' : '\u0421\u0440\u0435\u0434\u043D\u0438\u0439 \u043C\u043E\u043D\u0442\u0430\u0436 (\u20AC80-200)',\r\n    ord_long: lang === 'en' ? 'Long Video Edit (\u20AC200-350)' : '\u0414\u043B\u0438\u043D\u043D\u044B\u0439 \u043C\u043E\u043D\u0442\u0430\u0436 (\u20AC200-350)',\r\n    ord_ccsfx: lang === 'en' ? 'CC/SFX (\u20AC15-25)' : '\u0426\u0432\u0435\u0442\u043E\u043A\u043E\u0440/\u0417\u0432\u0443\u043A (\u20AC15-25)',\r\n    ord_logoanim: lang === 'en' ? 'Logo Animation (\u20AC80)' : '\u0410\u043D\u0438\u043C\u0430\u0446\u0438\u044F \u043B\u043E\u0433\u043E\u0442\u0438\u043F\u0430 (\u20AC80)',\r\n    ord_2danim: lang === 'en' ? '2D Animation (\u20AC70-80)' : '2D \u0410\u043D\u0438\u043C\u0430\u0446\u0438\u044F (\u20AC70-80)',\r\n    ord_promo: lang === 'en' ? 'Promo Video (\u20AC100-150)' : '\u041F\u0440\u043E\u043C\u043E \u0432\u0438\u0434\u0435\u043E (\u20AC100-150)',\r\n    ord_event: lang === 'en' ? 'Event Visuals (from \u20AC120)' : '\u0412\u0438\u0437\u0443\u0430\u043B\u044B \u0434\u043B\u044F \u0441\u043E\u0431\u044B\u0442\u0438\u0439 (\u043E\u0442 \u20AC120)'\r\n  }\r\n  \r\n  const serviceName = serviceNames[service] || 'Service'\r\n  const text = getText(userId, 'order_form', { service_name: serviceName })\r\n  \r\n  // Map service to category for back button\r\n  const categoryMap = {\r\n    ord_logo: 'cat_graphic', ord_brand: 'cat_graphic', ord_book: 'cat_graphic',\r\n    ord_icon: 'cat_graphic', ord_illust: 'cat_graphic',\r\n    ord_landing: 'cat_ui', ord_website: 'cat_ui', ord_mobile: 'cat_ui', ord_fullui: 'cat_ui',\r\n    ord_card: 'cat_print', ord_present: 'cat_print', ord_monthly: 'cat_print',\r\n    ord_short: 'cat_vfx', ord_medium: 'cat_vfx', ord_long: 'cat_vfx', ord_ccsfx: 'cat_vfx',\r\n    ord_logoanim: 'cat_motion', ord_2danim: 'cat_motion', ord_promo: 'cat_motion', ord_event: 'cat_motion'\r\n  }\r\n  \r\n  const backCategory = categoryMap[service] || 'main_menu'\r\n  \r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: getText(userId, 'back'), callback_data: backCategory }]\r\n    ]\r\n  }\r\n  \r\n  return { text, keyboard, photo: MEDIA_FILE_IDS.pricelist }\r\n}\r\n\r\n\r\n// Telegram file_id (faster and more reliable than URLs)\r\nconst MEDIA_FILE_IDS = {\r\n  logo: 'AgACAgIAAxkDAAN1aYO_kiHKSkVSM7Yy3avMyLIi0S8AAicWaxuDVhhIhD0t8uGw-P0BAAMCAAN4AAM4BA',\r\n  pricelist: 'AgACAgIAAxkDAAIBmGmF0cAwGwwPIQjBUL9gAxk1Lw6iAALfDmsbr9gxSKiiObd_5U_KAQADAgADeQADOAQ',\r\n  covers: 'AgACAgIAAxkDAAO8aYUIGz5J7UVpOauIT5KcvjXivGMAAvgTaxuz9ilIU2cMkhILjcMBAAMCAAN5AAM4BA',\r\n  posters: 'AgACAgIAAxkDAAO9aYUIHaym1b3ubLUGzPEFpytkyYkAAvkTaxuz9ilIhLgYx1Zmy7QBAAMCAAN5AAM4BA',\r\n  video: 'BAACAgIAAxkDAAIBTWmFy5jzcZDsBQXiHwrcWzwE1gABqgAC9ocAArP2MUgIFpUzdZd27TgE'\r\n}\r\n\r\n// Portfolio media URLs (using GitHub raw URLs or Telegram file_id)\r\n// You can replace these with your actual media URLs\r\nconst PORTFOLIO_MEDIA = {\r\n  covers: MEDIA_FILE_IDS.covers,\r\n  posters: MEDIA_FILE_IDS.posters,\r\n  video: MEDIA_FILE_IDS.video\r\n}\r\n\r\nasync function handleShowExamples(chatId, userId, token) {\r\n  const lang = getUserLanguage(userId)\r\n  \r\n  // Send cover example\r\n  const coverCaption = lang === 'ru'\r\n    ? `\uD83C\uDFA8 <b>\u041E\u0411\u041B\u041E\u0416\u041A\u0418 \u0418 \u0410\u0420\u0422\u0412\u041E\u0420\u041A\u0418</b>\r\n\r\n<b>\u041F\u0440\u0438\u043C\u0435\u0440\u044B \u0440\u0430\u0431\u043E\u0442:</b>\r\n\u2022 \u041E\u0431\u043B\u043E\u0436\u043A\u0438 \u0430\u043B\u044C\u0431\u043E\u043C\u043E\u0432\r\n\u2022 \u0421\u043D\u0438\u043F\u043F\u0435\u0442\u044B \u0434\u043B\u044F \u0442\u0440\u0435\u043A\u043E\u0432\r\n\u2022 \u0412\u0438\u0437\u0443\u0430\u043B\u044B \u0434\u043B\u044F \u0440\u0435\u043B\u0438\u0437\u043E\u0432\r\n\r\n<i>\u041A\u0430\u0436\u0434\u0430\u044F \u043E\u0431\u043B\u043E\u0436\u043A\u0430 \u0441\u043E\u0437\u0434\u0430\u0435\u0442\u0441\u044F \u0438\u043D\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043B\u044C\u043D\u043E \u043F\u043E\u0434 \u0432\u0430\u0448 \u0441\u0442\u0438\u043B\u044C</i>`\r\n    : `\uD83C\uDFA8 <b>COVERS & ARTWORK</b>\r\n\r\n<b>Work examples:</b>\r\n\u2022 Album covers\r\n\u2022 Track snippets\r\n\u2022 Release visuals\r\n\r\n<i>Each cover is created individually for your style</i>`\r\n  \r\n  await sendPhoto(chatId, PORTFOLIO_MEDIA.covers, coverCaption, null, token)\r\n  \r\n  // Small delay\r\n  await new Promise(resolve => setTimeout(resolve, 500))\r\n  \r\n  // Send poster example\r\n  const posterCaption = lang === 'ru'\r\n    ? `\uD83D\uDCC4 <b>\u041F\u041E\u0421\u0422\u0415\u0420\u042B \u0418 \u0410\u0424\u0418\u0428\u0418</b>\r\n\r\n<b>\u041F\u0440\u0438\u043C\u0435\u0440\u044B \u0440\u0430\u0431\u043E\u0442:</b>\r\n\u2022 \u041A\u043E\u043D\u0446\u0435\u0440\u0442\u043D\u044B\u0435 \u0430\u0444\u0438\u0448\u0438\r\n\u2022 \u041F\u0440\u043E\u043C\u043E \u043F\u043E\u0441\u0442\u0435\u0440\u044B\r\n\u2022 \u0418\u0432\u0435\u043D\u0442 \u0434\u0438\u0437\u0430\u0439\u043D\r\n\r\n<i>\u042F\u0440\u043A\u0438\u0435 \u0438 \u0437\u0430\u043F\u043E\u043C\u0438\u043D\u0430\u044E\u0449\u0438\u0435\u0441\u044F \u0434\u0438\u0437\u0430\u0439\u043D\u044B</i>`\r\n    : `\uD83D\uDCC4 <b>POSTERS & FLYERS</b>\r\n\r\n<b>Work examples:</b>\r\n\u2022 Concert posters\r\n\u2022 Promo materials\r\n\u2022 Event design\r\n\r\n<i>Bright and memorable designs</i>`\r\n  \r\n  await sendPhoto(chatId, PORTFOLIO_MEDIA.posters, posterCaption, null, token)\r\n  \r\n  // Small delay\r\n  await new Promise(resolve => setTimeout(resolve, 500))\r\n  \r\n  // Send video example\r\n  const videoCaption = lang === 'ru'\r\n    ? `\uD83C\uDFAC <b>\u0412\u0418\u0414\u0415\u041E\u041C\u041E\u041D\u0422\u0410\u0416 \u0418 \u041C\u041E\u0423\u0428\u041D</b>\r\n\r\n<b>\u041F\u0440\u0438\u043C\u0435\u0440\u044B \u0440\u0430\u0431\u043E\u0442:</b>\r\n\u2022 \u041C\u043E\u043D\u0442\u0430\u0436 \u0432\u0438\u0434\u0435\u043E\r\n\u2022 \u041C\u043E\u0443\u0448\u043D \u0433\u0440\u0430\u0444\u0438\u043A\u0430\r\n\u2022 VFX \u044D\u0444\u0444\u0435\u043A\u0442\u044B\r\n\r\n<i>\u0414\u0438\u043D\u0430\u043C\u0438\u0447\u043D\u044B\u0435 \u0438 \u043F\u0440\u043E\u0444\u0435\u0441\u0441\u0438\u043E\u043D\u0430\u043B\u044C\u043D\u044B\u0435 \u0440\u043E\u043B\u0438\u043A\u0438</i>`\r\n    : `\uD83C\uDFAC <b>VIDEO EDITING & MOTION</b>\r\n\r\n<b>Work examples:</b>\r\n\u2022 Video editing\r\n\u2022 Motion graphics\r\n\u2022 VFX effects\r\n\r\n<i>Dynamic and professional videos</i>`\r\n  \r\n  await sendVideo(chatId, PORTFOLIO_MEDIA.video, videoCaption, null, token)\r\n  \r\n  // Small delay\r\n  await new Promise(resolve => setTimeout(resolve, 500))\r\n  \r\n  // Final message with back button\r\n  const finalText = lang === 'ru'\r\n    ? `\u2728 <b>\u041D\u0440\u0430\u0432\u0438\u0442\u0441\u044F \u0442\u043E, \u0447\u0442\u043E \u0432\u0438\u0434\u0438\u0442\u0435?</b>\r\n\r\n\uD83D\uDCF8 <b>\u041F\u043E\u043B\u043D\u043E\u0435 \u043F\u043E\u0440\u0442\u0444\u043E\u043B\u0438\u043E:</b> @mindescrew\r\n\uD83D\uDCAC <b>\u0413\u043E\u0442\u043E\u0432\u044B \u0437\u0430\u043A\u0430\u0437\u0430\u0442\u044C?</b> \u0421\u0432\u044F\u0436\u0438\u0442\u0435\u0441\u044C \u0441 \u043D\u0430\u043C\u0438!\r\n\r\n<i>\u041A\u0430\u0436\u0434\u044B\u0439 \u043F\u0440\u043E\u0435\u043A\u0442 \u0443\u043D\u0438\u043A\u0430\u043B\u0435\u043D \u0438 \u0441\u043E\u0437\u0434\u0430\u0435\u0442\u0441\u044F \u043F\u043E\u0434 \u0432\u0430\u0448\u0438 \u043F\u043E\u0442\u0440\u0435\u0431\u043D\u043E\u0441\u0442\u0438</i>`\r\n    : `\u2728 <b>Like what you see?</b>\r\n\r\n\uD83D\uDCF8 <b>Full portfolio:</b> @mindescrew\r\n\uD83D\uDCAC <b>Ready to order?</b> Contact us!\r\n\r\n<i>Each project is unique and tailored to your needs</i>`\r\n  \r\n  const keyboard = {\r\n    inline_keyboard: [\r\n      [{ text: getText(userId, 'back'), callback_data: 'main_menu' }]\r\n    ]\r\n  }\r\n  \r\n  await sendMessage(chatId, finalText, keyboard, token)\r\n}\r\n\r\n// Admin API handlers\r\nasync function handleAdminAPI(request, env, url) {\r\n  const corsHeaders = {\r\n    'Access-Control-Allow-Origin': '*',\r\n    'Access-Control-Allow-Methods': 'GET, POST, DELETE, OPTIONS',\r\n    'Access-Control-Allow-Headers': 'Content-Type, X-User-ID',\r\n  }\r\n  \r\n  // Handle CORS preflight\r\n  if (request.method === 'OPTIONS') {\r\n    return new Response(null, { headers: corsHeaders })\r\n  }\r\n  \r\n  const path = url.pathname\r\n  \r\n  try {\r\n    // Handle order submission (no auth required)\r\n    if (path === '/api/order' && request.method === 'POST') {\r\n      const body = await request.json()\r\n      const { service, details, style, requirements, deadlineBudget, references, contact, userId, userName, userUsername } = body\r\n      \r\n      if (!service || !details || !deadlineBudget || !contact) {\r\n        return new Response(JSON.stringify({ error: 'Required fields missing' }), {\r\n          status: 400,\r\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n        })\r\n      }\r\n      \r\n      // Format order message for admin\r\n      const orderText = `\uD83D\uDD14 <b>\u041D\u041E\u0412\u042B\u0419 \u0417\u0410\u041A\u0410\u0417 \u0438\u0437 Mini App!</b>\r\n\r\n\uD83D\uDC64 <b>\u041A\u043B\u0438\u0435\u043D\u0442:</b> ${userName} (@${userUsername})\r\n\r\n\uD83D\uDCCB <b>\u0423\u0441\u043B\u0443\u0433\u0430:</b> ${service}\r\n\r\n\uD83D\uDCDD <b>\u0414\u0435\u0442\u0430\u043B\u0438:</b>\r\n${details}\r\n\r\n\uD83C\uDFA8 <b>\u0421\u0442\u0438\u043B\u044C \u0438 \u0446\u0432\u0435\u0442\u0430:</b>\r\n${style || '\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u043E'}\r\n\r\n\uD83D\uDCD0 <b>\u0422\u0440\u0435\u0431\u043E\u0432\u0430\u043D\u0438\u044F:</b>\r\n${requirements || '\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u043E'}\r\n\r\n\u23F0 <b>\u0421\u0440\u043E\u043A\u0438 \u0438 \u0431\u044E\u0434\u0436\u0435\u0442:</b>\r\n${deadlineBudget}\r\n\r\n\uD83D\uDD17 <b>\u0420\u0435\u0444\u0435\u0440\u0435\u043D\u0441\u044B:</b>\r\n${references || '\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u043E'}\r\n\r\n\uFFFD <b>\u041A\u043E\u043D\u0442\u0430\u043A\u0442:</b> ${contact}\r\n\r\n\u23F1 <b>\u0412\u0440\u0435\u043C\u044F:</b> ${new Date().toLocaleString('ru-RU', { timeZone: 'Europe/Moscow' })}`\r\n      \r\n      // Send to admin\r\n      const ADMIN_CHAT_ID = env.ADMIN_CHAT_ID\r\n      const BOT_TOKEN = env.BOT_TOKEN\r\n      \r\n      if (ADMIN_CHAT_ID && BOT_TOKEN) {\r\n        const telegramUrl = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`\r\n        await fetch(telegramUrl, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            chat_id: ADMIN_CHAT_ID,\r\n            text: orderText,\r\n            parse_mode: 'HTML'\r\n          })\r\n        })\r\n      }\r\n      \r\n      return new Response(JSON.stringify({ success: true }), {\r\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n      })\r\n    }\r\n    \r\n    // Check admin authorization for other endpoints\r\n    const userId = request.headers.get('X-User-ID')\r\n    if (!userId || parseInt(userId) !== ADMIN_USER_ID) {\r\n      return new Response(JSON.stringify({ error: 'Unauthorized' }), {\r\n        status: 403,\r\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n      })\r\n    }\r\n    \r\n    // Get portfolio items\r\n    if (path === '/api/portfolio' && request.method === 'GET') {\r\n      const category = url.searchParams.get('category')\r\n      if (!category) {\r\n        return new Response(JSON.stringify({ error: 'Category required' }), {\r\n          status: 400,\r\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n        })\r\n      }\r\n      \r\n      const key = `portfolio_${category}`\r\n      const data = await env.PORTFOLIO_KV.get(key, 'json')\r\n      \r\n      return new Response(JSON.stringify({ items: data || [] }), {\r\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n      })\r\n    }\r\n    \r\n    // Add portfolio item\r\n    if (path === '/api/portfolio' && request.method === 'POST') {\r\n      const body = await request.json()\r\n      const { category, item } = body\r\n      \r\n      if (!category || !item) {\r\n        return new Response(JSON.stringify({ error: 'Category and item required' }), {\r\n          status: 400,\r\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n        })\r\n      }\r\n      \r\n      const key = `portfolio_${category}`\r\n      const data = await env.PORTFOLIO_KV.get(key, 'json') || []\r\n      \r\n      // Add new item with ID\r\n      const newItem = {\r\n        ...item,\r\n        id: Date.now().toString(),\r\n        createdAt: new Date().toISOString()\r\n      }\r\n      \r\n      data.push(newItem)\r\n      await env.PORTFOLIO_KV.put(key, JSON.stringify(data))\r\n      \r\n      return new Response(JSON.stringify({ success: true, item: newItem }), {\r\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n      })\r\n    }\r\n    \r\n    // Update portfolio items (for edit functionality)\r\n    if (path === '/api/portfolio/update' && request.method === 'POST') {\r\n      const body = await request.json()\r\n      const { category, items } = body\r\n      \r\n      if (!category || !items) {\r\n        return new Response(JSON.stringify({ error: 'Category and items required' }), {\r\n          status: 400,\r\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n        })\r\n      }\r\n      \r\n      const key = `portfolio_${category}`\r\n      await env.PORTFOLIO_KV.put(key, JSON.stringify(items))\r\n      \r\n      return new Response(JSON.stringify({ success: true }), {\r\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n      })\r\n    }\r\n    \r\n    // Delete portfolio item\r\n    if (path === '/api/portfolio' && request.method === 'DELETE') {\r\n      const category = url.searchParams.get('category')\r\n      const itemId = url.searchParams.get('id')\r\n      \r\n      if (!category || !itemId) {\r\n        return new Response(JSON.stringify({ error: 'Category and ID required' }), {\r\n          status: 400,\r\n          headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n        })\r\n      }\r\n      \r\n      const key = `portfolio_${category}`\r\n      const data = await env.PORTFOLIO_KV.get(key, 'json') || []\r\n      \r\n      const filtered = data.filter(item => item.id !== itemId)\r\n      await env.PORTFOLIO_KV.put(key, JSON.stringify(filtered))\r\n      \r\n      return new Response(JSON.stringify({ success: true }), {\r\n        headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n      })\r\n    }\r\n    \r\n    return new Response(JSON.stringify({ error: 'Not found' }), {\r\n      status: 404,\r\n      headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n    })\r\n    \r\n  } catch (error) {\r\n    return new Response(JSON.stringify({ error: error.message }), {\r\n      status: 500,\r\n      headers: { ...corsHeaders, 'Content-Type': 'application/json' }\r\n    })\r\n  }\r\n}\r\n\r\n// Main request handler\r\nasync function handleRequest(request, env) {\r\n  // Check if environment variables are set\r\n  if (!env || !env.BOT_TOKEN) {\r\n    return new Response('\u274C BOT_TOKEN not configured. Add it in Workers Settings \u2192 Variables', { \r\n      status: 500,\r\n      headers: { 'Content-Type': 'text/plain; charset=utf-8' }\r\n    })\r\n  }\r\n  \r\n  const BOT_TOKEN = env.BOT_TOKEN\r\n  const ADMIN_CHAT_ID = env.ADMIN_CHAT_ID || null\r\n  const url = new URL(request.url)\r\n  \r\n  // Handle API endpoints for admin panel\r\n  if (url.pathname.startsWith('/api/')) {\r\n    return handleAdminAPI(request, env, url)\r\n  }\r\n  \r\n  // Handle GET requests (health check)\r\n  if (request.method === 'GET') {\r\n    return new Response('\uD83E\uDD16 MCREW Bot is running on Cloudflare Workers!', { \r\n      status: 200,\r\n      headers: { 'Content-Type': 'text/plain; charset=utf-8' }\r\n    })\r\n  }\r\n  \r\n  // Handle POST requests (Telegram updates)\r\n  if (request.method === 'POST') {\r\n    try {\r\n      const update = await request.json()\r\n      \r\n      // Handle regular messages\r\n      if (update.message) {\r\n        const chatId = update.message.chat.id\r\n        const userId = update.message.from.id\r\n        const text = update.message.text || ''\r\n        const user = update.message.from\r\n        \r\n        // Admin file upload handling\r\n        if (userId === ADMIN_USER_ID) {\r\n          // Handle photo uploads for portfolio\r\n          if (update.message.photo) {\r\n            const photo = update.message.photo[update.message.photo.length - 1] // Get largest photo\r\n            const caption = update.message.caption || ''\r\n            \r\n            // Parse caption: category|artist|track or category|title\r\n            const parts = caption.split('|').map(p => p.trim())\r\n            \r\n            if (parts.length >= 1) {\r\n              const category = parts[0].toLowerCase() // covers, posters, motion\r\n              \r\n              if (['covers', 'posters', 'motion'].includes(category)) {\r\n                // Get file URL from Telegram\r\n                const fileResponse = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/getFile?file_id=${photo.file_id}`)\r\n                const fileData = await fileResponse.json()\r\n                \r\n                if (!fileData.ok) {\r\n                  await sendMessage(chatId, `\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0444\u0430\u0439\u043B\u0430`, null, BOT_TOKEN)\r\n                  return new Response('OK', { status: 200 })\r\n                }\r\n                \r\n                const fileUrl = `https://api.telegram.org/file/bot${BOT_TOKEN}/${fileData.result.file_path}`\r\n                \r\n                let item = {\r\n                  type: 'photo',\r\n                  file: fileUrl,\r\n                  file_id: photo.file_id,\r\n                  id: Date.now().toString(),\r\n                  createdAt: new Date().toISOString()\r\n                }\r\n                \r\n                if (category === 'covers' && parts.length >= 3) {\r\n                  // Track cover: covers|artist|track\r\n                  item.type = 'track'\r\n                  item.artist = parts[1]\r\n                  item.track = parts[2]\r\n                  item.cover = fileUrl\r\n                  item.cover_file_id = photo.file_id\r\n                  item.audio = null // Will be added separately\r\n                  delete item.file\r\n                  delete item.file_id\r\n                } else {\r\n                  // Photo/poster\r\n                  item.title = { en: parts[1] || 'Portfolio Item', ru: parts[1] || '\u042D\u043B\u0435\u043C\u0435\u043D\u0442 \u043F\u043E\u0440\u0442\u0444\u043E\u043B\u0438\u043E' }\r\n                  item.description = { en: 'Portfolio work', ru: '\u0420\u0430\u0431\u043E\u0442\u0430 \u0438\u0437 \u043F\u043E\u0440\u0442\u0444\u043E\u043B\u0438\u043E' }\r\n                }\r\n                \r\n                // Save to KV\r\n                const key = `portfolio_${category}`\r\n                const data = await env.PORTFOLIO_KV.get(key, 'json') || []\r\n                data.push(item)\r\n                await env.PORTFOLIO_KV.put(key, JSON.stringify(data))\r\n                \r\n                await sendMessage(chatId, `\u2705 \u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E \u0432 ${category}!\\n\\nItem ID: ${item.id}`, null, BOT_TOKEN)\r\n              } else {\r\n                await sendMessage(chatId, `\u274C \u041D\u0435\u0432\u0435\u0440\u043D\u0430\u044F \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F. \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439: covers, posters \u0438\u043B\u0438 motion\\n\\n\u041F\u0440\u0438\u043C\u0435\u0440:\\ncovers|\u0418\u043C\u044F \u0430\u0440\u0442\u0438\u0441\u0442\u0430|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0442\u0440\u0435\u043A\u0430`, null, BOT_TOKEN)\r\n              }\r\n            } else {\r\n              await sendMessage(chatId, `\uD83D\uDCDD \u041E\u0442\u043F\u0440\u0430\u0432\u044C \u0444\u043E\u0442\u043E \u0441 \u043F\u043E\u0434\u043F\u0438\u0441\u044C\u044E:\\n\\n<b>\u0414\u043B\u044F \u043E\u0431\u043B\u043E\u0436\u043A\u0438 \u0442\u0440\u0435\u043A\u0430:</b>\\ncovers|\u0418\u043C\u044F \u0430\u0440\u0442\u0438\u0441\u0442\u0430|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0442\u0440\u0435\u043A\u0430\\n\\n<b>\u0414\u043B\u044F \u043F\u043E\u0441\u0442\u0435\u0440\u0430:</b>\\nposters|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435\\n\\n<b>\u0414\u043B\u044F \u043C\u043E\u0443\u0448\u043D:</b>\\nmotion|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435`, null, BOT_TOKEN)\r\n            }\r\n            return new Response('OK', { status: 200 })\r\n          }\r\n          \r\n          // Handle audio uploads for tracks\r\n          if (update.message.audio || update.message.voice || update.message.document) {\r\n            const audio = update.message.audio || update.message.voice || update.message.document\r\n            const caption = update.message.caption || ''\r\n            \r\n            // Get audio file URL\r\n            const audioFileResponse = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/getFile?file_id=${audio.file_id}`)\r\n            const audioFileData = await audioFileResponse.json()\r\n            \r\n            if (!audioFileData.ok) {\r\n              await sendMessage(chatId, `\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0430\u0443\u0434\u0438\u043E \u0444\u0430\u0439\u043B\u0430`, null, BOT_TOKEN)\r\n              return new Response('OK', { status: 200 })\r\n            }\r\n            \r\n            const audioUrl = `https://api.telegram.org/file/bot${BOT_TOKEN}/${audioFileData.result.file_path}`\r\n            \r\n            // Parse caption: itemId or category|artist|track\r\n            if (caption) {\r\n              const parts = caption.split('|').map(p => p.trim())\r\n              \r\n              if (parts.length === 1) {\r\n                // Update existing track with audio: itemId\r\n                const itemId = parts[0]\r\n                const key = 'portfolio_covers'\r\n                const data = await env.PORTFOLIO_KV.get(key, 'json') || []\r\n                \r\n                const item = data.find(i => i.id === itemId)\r\n                if (item && item.type === 'track') {\r\n                  item.audio = audioUrl\r\n                  item.audio_file_id = audio.file_id\r\n                  await env.PORTFOLIO_KV.put(key, JSON.stringify(data))\r\n                  await sendMessage(chatId, `\u2705 \u0410\u0443\u0434\u0438\u043E \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E \u043A \u0442\u0440\u0435\u043A\u0443!\\n\\n\u0410\u0440\u0442\u0438\u0441\u0442: ${item.artist}\\n\u0422\u0440\u0435\u043A: ${item.track}`, null, BOT_TOKEN)\r\n                } else {\r\n                  await sendMessage(chatId, `\u274C \u0422\u0440\u0435\u043A \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0441 ID: ${itemId}`, null, BOT_TOKEN)\r\n                }\r\n              } else if (parts.length >= 3) {\r\n                // Create new track with audio: covers|artist|track\r\n                const category = parts[0].toLowerCase()\r\n                if (category === 'covers') {\r\n                  const item = {\r\n                    type: 'track',\r\n                    artist: parts[1],\r\n                    track: parts[2],\r\n                    cover: null, // Will be added separately\r\n                    audio: audioUrl,\r\n                    audio_file_id: audio.file_id,\r\n                    id: Date.now().toString(),\r\n                    createdAt: new Date().toISOString()\r\n                  }\r\n                  \r\n                  const key = 'portfolio_covers'\r\n                  const data = await env.PORTFOLIO_KV.get(key, 'json') || []\r\n                  data.push(item)\r\n                  await env.PORTFOLIO_KV.put(key, JSON.stringify(data))\r\n                  \r\n                  await sendMessage(chatId, `\u2705 \u0422\u0440\u0435\u043A \u0441\u043E\u0437\u0434\u0430\u043D!\\n\\nItem ID: ${item.id}\\n\\n\u0422\u0435\u043F\u0435\u0440\u044C \u043E\u0442\u043F\u0440\u0430\u0432\u044C \u043E\u0431\u043B\u043E\u0436\u043A\u0443 \u0441 \u043F\u043E\u0434\u043F\u0438\u0441\u044C\u044E:\\n${item.id}`, null, BOT_TOKEN)\r\n                }\r\n              }\r\n            } else {\r\n              await sendMessage(chatId, `\uD83D\uDCDD \u041E\u0442\u043F\u0440\u0430\u0432\u044C \u0430\u0443\u0434\u0438\u043E \u0441 \u043F\u043E\u0434\u043F\u0438\u0441\u044C\u044E:\\n\\n<b>\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0430\u0443\u0434\u0438\u043E \u043A \u0442\u0440\u0435\u043A\u0443:</b>\\nitemId\\n\\n<b>\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u0442\u0440\u0435\u043A:</b>\\ncovers|\u0418\u043C\u044F \u0430\u0440\u0442\u0438\u0441\u0442\u0430|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0442\u0440\u0435\u043A\u0430`, null, BOT_TOKEN)\r\n            }\r\n            return new Response('OK', { status: 200 })\r\n          }\r\n          \r\n          // Handle video uploads\r\n          if (update.message.video) {\r\n            const video = update.message.video\r\n            const caption = update.message.caption || ''\r\n            \r\n            // Get video file URL\r\n            const videoFileResponse = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/getFile?file_id=${video.file_id}`)\r\n            const videoFileData = await videoFileResponse.json()\r\n            \r\n            if (!videoFileData.ok) {\r\n              await sendMessage(chatId, `\u274C \u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0432\u0438\u0434\u0435\u043E \u0444\u0430\u0439\u043B\u0430`, null, BOT_TOKEN)\r\n              return new Response('OK', { status: 200 })\r\n            }\r\n            \r\n            const videoUrl = `https://api.telegram.org/file/bot${BOT_TOKEN}/${videoFileData.result.file_path}`\r\n            \r\n            const parts = caption.split('|').map(p => p.trim())\r\n            \r\n            if (parts.length >= 1) {\r\n              const category = parts[0].toLowerCase()\r\n              \r\n              if (category === 'motion') {\r\n                const item = {\r\n                  type: 'video',\r\n                  file: videoUrl,\r\n                  file_id: video.file_id,\r\n                  title: { en: parts[1] || 'Video', ru: parts[1] || '\u0412\u0438\u0434\u0435\u043E' },\r\n                  description: { en: 'Motion graphics', ru: '\u041C\u043E\u0443\u0448\u043D \u0433\u0440\u0430\u0444\u0438\u043A\u0430' },\r\n                  id: Date.now().toString(),\r\n                  createdAt: new Date().toISOString()\r\n                }\r\n                \r\n                const key = 'portfolio_motion'\r\n                const data = await env.PORTFOLIO_KV.get(key, 'json') || []\r\n                data.push(item)\r\n                await env.PORTFOLIO_KV.put(key, JSON.stringify(data))\r\n                \r\n                await sendMessage(chatId, `\u2705 \u0412\u0438\u0434\u0435\u043E \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E \u0432 motion!\\n\\nItem ID: ${item.id}`, null, BOT_TOKEN)\r\n              } else {\r\n                await sendMessage(chatId, `\u274C \u041D\u0435\u0432\u0435\u0440\u043D\u0430\u044F \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F. \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439: motion\\n\\n\u041F\u0440\u0438\u043C\u0435\u0440:\\nmotion|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0432\u0438\u0434\u0435\u043E`, null, BOT_TOKEN)\r\n              }\r\n            } else {\r\n              await sendMessage(chatId, `\uD83D\uDCDD \u041E\u0442\u043F\u0440\u0430\u0432\u044C \u0432\u0438\u0434\u0435\u043E \u0441 \u043F\u043E\u0434\u043F\u0438\u0441\u044C\u044E:\\n\\nmotion|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0432\u0438\u0434\u0435\u043E`, null, BOT_TOKEN)\r\n            }\r\n            return new Response('OK', { status: 200 })\r\n          }\r\n          \r\n          // Admin commands\r\n          if (text === '/admin' || text === '/help') {\r\n            const helpText = `\uD83D\uDD27 <b>\u041A\u041E\u041C\u0410\u041D\u0414\u042B \u0410\u0414\u041C\u0418\u041D\u0410</b>\r\n\r\n<b>\uD83D\uDCF8 \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043E\u0431\u043B\u043E\u0436\u043A\u0443 \u0442\u0440\u0435\u043A\u0430:</b>\r\n1. \u041E\u0442\u043F\u0440\u0430\u0432\u044C \u0444\u043E\u0442\u043E \u0441 \u043F\u043E\u0434\u043F\u0438\u0441\u044C\u044E:\r\n   <code>covers|\u0418\u043C\u044F \u0430\u0440\u0442\u0438\u0441\u0442\u0430|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0442\u0440\u0435\u043A\u0430</code>\r\n2. \u041F\u043E\u043B\u0443\u0447\u0438\u0448\u044C Item ID\r\n3. \u041E\u0442\u043F\u0440\u0430\u0432\u044C \u0430\u0443\u0434\u0438\u043E \u0441 \u043F\u043E\u0434\u043F\u0438\u0441\u044C\u044E:\r\n   <code>ItemID</code>\r\n\r\n<b>\uD83D\uDDBC\uFE0F \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u043E\u0441\u0442\u0435\u0440:</b>\r\n\u041E\u0442\u043F\u0440\u0430\u0432\u044C \u0444\u043E\u0442\u043E \u0441 \u043F\u043E\u0434\u043F\u0438\u0441\u044C\u044E:\r\n<code>posters|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435</code>\r\n\r\n<b>\uD83C\uDFAC \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432\u0438\u0434\u0435\u043E:</b>\r\n\u041E\u0442\u043F\u0440\u0430\u0432\u044C \u0432\u0438\u0434\u0435\u043E \u0441 \u043F\u043E\u0434\u043F\u0438\u0441\u044C\u044E:\r\n<code>motion|\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435</code>\r\n\r\n<b>\uD83D\uDDD1\uFE0F \u0423\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u043B\u0435\u043C\u0435\u043D\u0442:</b>\r\n<code>/delete \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F itemId</code>\r\n\u041F\u0440\u0438\u043C\u0435\u0440: <code>/delete covers 1234567890</code>\r\n\r\n<b>\uD83D\uDCCB \u0421\u043F\u0438\u0441\u043E\u043A \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432:</b>\r\n<code>/list \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F</code>\r\n\u041F\u0440\u0438\u043C\u0435\u0440: <code>/list covers</code>`\r\n            \r\n            await sendMessage(chatId, helpText, null, BOT_TOKEN)\r\n            return new Response('OK', { status: 200 })\r\n          }\r\n          \r\n          // Delete command\r\n          if (text.startsWith('/delete ')) {\r\n            const parts = text.split(' ')\r\n            if (parts.length === 3) {\r\n              const category = parts[1]\r\n              const itemId = parts[2]\r\n              \r\n              const key = `portfolio_${category}`\r\n              const data = await env.PORTFOLIO_KV.get(key, 'json') || []\r\n              const filtered = data.filter(item => item.id !== itemId)\r\n              \r\n              if (filtered.length < data.length) {\r\n                await env.PORTFOLIO_KV.put(key, JSON.stringify(filtered))\r\n                await sendMessage(chatId, `\u2705 \u042D\u043B\u0435\u043C\u0435\u043D\u0442 \u0443\u0434\u0430\u043B\u0435\u043D \u0438\u0437 ${category}!`, null, BOT_TOKEN)\r\n              } else {\r\n                await sendMessage(chatId, `\u274C \u042D\u043B\u0435\u043C\u0435\u043D\u0442 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D`, null, BOT_TOKEN)\r\n              }\r\n            } else {\r\n              await sendMessage(chatId, `\u274C \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u0435: /delete \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F itemId`, null, BOT_TOKEN)\r\n            }\r\n            return new Response('OK', { status: 200 })\r\n          }\r\n          \r\n          // List command\r\n          if (text.startsWith('/list ')) {\r\n            const category = text.split(' ')[1]\r\n            const key = `portfolio_${category}`\r\n            const data = await env.PORTFOLIO_KV.get(key, 'json') || []\r\n            \r\n            if (data.length === 0) {\r\n              await sendMessage(chatId, `\uD83D\uDCED \u041D\u0435\u0442 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432 \u0432 ${category}`, null, BOT_TOKEN)\r\n            } else {\r\n              let listText = `\uD83D\uDCCB <b>${category.toUpperCase()}</b> (${data.length} \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432)\\n\\n`\r\n              data.forEach((item, i) => {\r\n                if (item.type === 'track') {\r\n                  listText += `${i + 1}. ${item.artist} - ${item.track}\\n   ID: <code>${item.id}</code>\\n\\n`\r\n                } else {\r\n                  const title = item.title?.en || item.title || 'Item'\r\n                  listText += `${i + 1}. ${title}\\n   ID: <code>${item.id}</code>\\n\\n`\r\n                }\r\n              })\r\n              await sendMessage(chatId, listText, null, BOT_TOKEN)\r\n            }\r\n            return new Response('OK', { status: 200 })\r\n          }\r\n        }\r\n        \r\n        // Regular user messages - only /start command\r\n        if (text === '/start') {\r\n          // Just send a message to use Mini App\r\n          const welcomeText = currentLang === 'en' \r\n            ? '\uD83D\uDC4B Welcome to MCREW Design Studio!\\n\\n\uD83C\uDFA8 Use the Mini App button below to view our services and place an order.'\r\n            : '\uD83D\uDC4B \u0414\u043E\u0431\u0440\u043E \u043F\u043E\u0436\u0430\u043B\u043E\u0432\u0430\u0442\u044C \u0432 MCREW Design Studio!\\n\\n\uD83C\uDFA8 \u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u043A\u043D\u043E\u043F\u043A\u0443 Mini App \u043D\u0438\u0436\u0435, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u043D\u0430\u0448\u0438 \u0443\u0441\u043B\u0443\u0433\u0438 \u0438 \u043E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437.'\r\n          \r\n          await sendMessage(chatId, welcomeText, null, BOT_TOKEN)\r\n        }\r\n        // Ignore all other messages from regular users\r\n      }\r\n      \r\n      // Handle callback queries (button clicks)\r\n      else if (update.callback_query) {\r\n        const query = update.callback_query\r\n        const chatId = query.message.chat.id\r\n        const messageId = query.message.message_id\r\n        const userId = query.from.id\r\n        const callbackData = query.data\r\n        \r\n        // Answer callback query immediately\r\n        await answerCallbackQuery(query.id, BOT_TOKEN)\r\n        \r\n        let response\r\n        \r\n        // Route to appropriate handler\r\n        switch (callbackData) {\r\n          case 'cat_graphic':\r\n            response = handleGraphicDesign(userId)\r\n            break\r\n          case 'cat_ui':\r\n            response = handleUIDesign(userId)\r\n            break\r\n          case 'cat_print':\r\n            response = handlePrint(userId)\r\n            break\r\n          case 'cat_vfx':\r\n            response = handleVFX(userId)\r\n            break\r\n          case 'cat_motion':\r\n            response = handleMotion(userId)\r\n            break\r\n          case 'show_portfolio':\r\n            response = handlePortfolio(userId)\r\n            break\r\n          case 'show_examples':\r\n            // Delete original message and send examples\r\n            await deleteMessage(chatId, messageId, BOT_TOKEN)\r\n            await handleShowExamples(chatId, userId, BOT_TOKEN)\r\n            response = null // Already handled\r\n            break\r\n          case 'show_contact':\r\n            response = handleContact(userId)\r\n            break\r\n          case 'show_language':\r\n            response = handleLanguageMenu(userId)\r\n            break\r\n          case 'lang_en':\r\n            setUserLanguage(userId, 'en')\r\n            response = { \r\n              text: getText(userId, 'menu_title'), \r\n              keyboard: getMainMenuKeyboard(userId),\r\n              photo: MEDIA_FILE_IDS.logo\r\n            }\r\n            break\r\n          case 'lang_ru':\r\n            setUserLanguage(userId, 'ru')\r\n            response = { \r\n              text: getText(userId, 'menu_title'), \r\n              keyboard: getMainMenuKeyboard(userId),\r\n              photo: MEDIA_FILE_IDS.logo\r\n            }\r\n            break\r\n          case 'main_menu':\r\n            response = { \r\n              text: getText(userId, 'menu_title'), \r\n              keyboard: getMainMenuKeyboard(userId),\r\n              photo: MEDIA_FILE_IDS.logo\r\n            }\r\n            break\r\n          default:\r\n            if (callbackData.startsWith('ord_')) {\r\n              response = handleOrder(userId, callbackData)\r\n            } else {\r\n              response = { \r\n                text: getText(userId, 'menu_title'), \r\n                keyboard: getMainMenuKeyboard(userId),\r\n                photo: MEDIA_FILE_IDS.logo\r\n              }\r\n            }\r\n        }\r\n        \r\n        // Handle response - edit message with new photo and text\r\n        if (response) {\r\n          if (response.photo) {\r\n            // Edit message media (change photo and caption)\r\n            await editMessageMedia(chatId, messageId, response.photo, response.text, response.keyboard, BOT_TOKEN)\r\n          } else {\r\n            // Fallback to text edit if no photo specified\r\n            await editMessageText(chatId, messageId, response.text, response.keyboard, BOT_TOKEN)\r\n          }\r\n        }\r\n      }\r\n      \r\n      // Handle web app data (Mini App orders)\r\n      else if (update.message && update.message.web_app_data) {\r\n        const chatId = update.message.chat.id\r\n        const userId = update.message.from.id\r\n        const user = update.message.from\r\n        const webAppData = JSON.parse(update.message.web_app_data.data)\r\n        \r\n        // Format order message for admin\r\n        const orderText = `\uD83D\uDD14 <b>NEW ORDER from Mini App!</b>\r\n\r\n\uD83D\uDC64 <b>Client:</b> ${user.first_name || 'Unknown'} ${user.last_name || ''} (@${user.username || 'no_username'})\r\n\uD83C\uDD94 <b>User ID:</b> ${userId}\r\n\r\n\uD83D\uDCCB <b>Service:</b> ${webAppData.service}\r\n\r\n\uD83D\uDCDD <b>Details:</b>\r\n${webAppData.details}\r\n\r\n\uD83C\uDFA8 <b>Style & Colors:</b>\r\n${webAppData.style || 'Not specified'}\r\n\r\n\uD83D\uDCD0 <b>Requirements:</b>\r\n${webAppData.requirements || 'Not specified'}\r\n\r\n\u23F0 <b>Deadline & Budget:</b>\r\n${webAppData.deadlineBudget}\r\n\r\n\uD83D\uDD17 <b>References:</b>\r\n${webAppData.references || 'Not specified'}\r\n\r\n\uD83D\uDCDE <b>Contact:</b> ${webAppData.contact}\r\n\r\n\u23F1 <b>Time:</b> ${new Date().toLocaleString('ru-RU', { timeZone: 'Europe/Moscow' })}`\r\n        \r\n        // Send to admin\r\n        if (ADMIN_CHAT_ID) {\r\n          await sendMessage(ADMIN_CHAT_ID, orderText, null, BOT_TOKEN)\r\n        }\r\n        \r\n        // Reply to user\r\n        const lang = getUserLanguage(userId)\r\n        const replyText = lang === 'ru' \r\n          ? '\u2705 <b>\u0421\u043F\u0430\u0441\u0438\u0431\u043E \u0437\u0430 \u0432\u0430\u0448 \u0437\u0430\u043A\u0430\u0437!</b>\\n\\n\u041C\u044B \u043F\u043E\u043B\u0443\u0447\u0438\u043B\u0438 \u0432\u0430\u0448\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0438 \u0441\u0432\u044F\u0436\u0435\u043C\u0441\u044F \u0441 \u0432\u0430\u043C\u0438 \u0432 \u0442\u0435\u0447\u0435\u043D\u0438\u0435 2 \u0447\u0430\u0441\u043E\u0432.\\n\\n\uD83D\uDCAC \u0412\u043E\u043F\u0440\u043E\u0441\u044B? \u041F\u0438\u0448\u0438\u0442\u0435 @mcrewdm'\r\n          : '\u2705 <b>Thank you for your order!</b>\\n\\nWe received your message and will contact you within 2 hours.\\n\\n\uD83D\uDCAC Questions? Write @mcrewdm'\r\n        \r\n        await sendMessage(chatId, replyText, null, BOT_TOKEN)\r\n      }\r\n      \r\n      return new Response('OK', { status: 200 })\r\n      \r\n    } catch (error) {\r\n      console.error('Error processing update:', error)\r\n      console.error('Error stack:', error.stack)\r\n      console.error('Error message:', error.message)\r\n      \r\n      // Return detailed error for debugging\r\n      return new Response(JSON.stringify({\r\n        error: error.message,\r\n        stack: error.stack,\r\n        update: 'Check logs for details'\r\n      }), { \r\n        status: 500,\r\n        headers: { 'Content-Type': 'application/json' }\r\n      })\r\n    }\r\n  }\r\n  \r\n  return new Response('Method not allowed', { status: 405 })\r\n}\r\n"],
  "mappings": "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",
  "names": ["userId"]
}
